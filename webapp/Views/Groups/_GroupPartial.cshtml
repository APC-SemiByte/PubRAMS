@model webapp.Models.ViewModels.GroupViewModel;

<div class="new-placeholder"></div>

<div class="group-container"
    <h1>@Model.Id: @Model.Name</h1>
    <p>Leader: @Model.Leader.Email</p>
    <form>
        <input name="GroupName" class="invisible group-name" value="@Model.Name" />
        <select name="StudentEmail"
            hx-get="/Form/GroupMembers"
            hx-trigger="intersect once"
            hx-include="previous .group-name"
            hx-params="GroupName"
            hx-target="this"
            hx-swap="innerHTML"
            hx-disabled-elt="next .add-member"
        >
            <!option>Loading...</!option>
        </select>
        <button class="btn btn-primary add-member"
            hx-post="/Groups/ChangeLeader"
            hx-trigger="click"
            hx-target="closest .group-container"
            hx-swap="outerHTML"
            hx-confirm="Are you sure you want this student be the leader of @Model.Name?"
        >
            Change Leader
        </button>
    </form>
    <h5>Members: </h5>
    <form>
        <input name="GroupName" class="invisible group-name" value="@Model.Name" />
        <select name="StudentEmail"
            hx-get="/Form/NonGroupMembers"
            hx-trigger="intersect once"
            hx-include="previous .group-name"
            hx-params="GroupName"
            hx-target="this"
            hx-swap="innerHTML"
            hx-disabled-elt="next .add-member"
        >
            <!option>Loading...</!option>
        </select>

        <button class="btn btn-primary add-member"
            hx-post="/Groups/AddMember"
            hx-trigger="click"
            hx-target="closest .group-container"
            hx-swap="outerHTML"
            hx-confirm="Are you sure you want to add this member to @Model.Name?"
        >
            Add Member
        </button>
    </form>
    <ul>
        @foreach(var member in Model.Members)
        {
        <form>
            <input name="GroupName" class="invisible" value="@Model.Name" />
            <input name="StudentEmail" class="invisible" value="@member.Email" />
            <li>@member.FirstName @member.LastName</li>

            @if (member.Email != Model.Leader.Email)
            {
            <button class="btn btn-danger"
                class="btn btn-primary"
                hx-post="/Groups/RemoveMember"
                hx-trigger="click"
                hx-target="closest .group-container"
                hx-swap="outerHTML"
                hx-confirm="Are you sure you want to remove this member?"
            >
                Remove Member
            </button>
            }

        </form>
        }
    </ul>
</div>
